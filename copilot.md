# LLMを活用したソフトウェア開発の進め方（拡張版）

## 👥 人とLLMの役割分担について

この開発手法では、**人間がプロジェクト全体の管理とフェーズごとの作業指示を行い、LLMがその指示に基づいて実際の作業（提案・文書生成・コード生成など）を担当**します。

- 人間：目的設定・作業のスコープ管理・レビュー・進行判断を担う
- LLM：人からの明示的な指示に従い、成果物を生成する支援者となる

この構造を明確に保つことで、LLMの暴走や意図と異なる出力を防ぎ、人間が常に進行をコントロールできるようにします。

## ❓ なぜ今、ウォーターフォールなのか？

アジャイル開発が主流となった現代において、ウォーターフォール型の進行は時代遅れと思われがちです。
しかし、**LLM（大規模言語モデル）との協調においては、ウォーターフォールの持つ「段階的」「成果物単位」「進行順序の明確さ」**が極めて有効です。

- LLMは段階的に情報を整理し、明確な入力と出力の繰り返しに強みがある
- コンテキストサイズの制約を受けるため、フェーズごとの明確な区切りが必要
- 一貫した成果物ベースの進行が、手戻りや誤解を減らす

そのため、**ウォーターフォールの構造を再評価し、「LLMに最適化したフェーズ進行モデル」として再構築する意義**があります。

## 🧭 概念：LLM連携型ウォーターフォール開発

この開発手法では、プロジェクト全体を段階的にフェーズ分割し、各フェーズにおいて明確な目的と成果物を設定します。LLMはあくまで人の明示的な指示に従って各フェーズ内の作業を支援する立場であり、人間が全体の進行を制御します。

また、各フェーズの終了時には必ずレビューと成果物の検証を行い、次のフェーズに進めるかどうかを判断します。こうした一貫した進行管理により、LLMとの協調開発が安定的かつ効率的に進行します。

## 📌 フェーズ横断の共通情報提示について

各フェーズでは、**前工程の成果物に加えて、共通情報（プロジェクト名、目的、前提条件、主要技術スタックなど）を構造的に再掲**することで、LLMが安定した出力を行えるようになります。

### 🔁 共通情報提示テンプレート（例）

```
【共通情報】
- プロジェクト名：顔ぼかしアプリ
- プロジェクト目的：ユーザーがWeb上で写真をアップロードし、顔をぼかす
- 主な利用者：スマートフォンを利用する一般ユーザー
- 保存形式：JPEG
- 使用言語・技術：C#、Blazor WebAssembly、ASP.NET Core Web API
- セキュリティ要件：画像データはサーバーに一時保存後、自動削除
```

この形式を各フェーズ開始時のプロンプト冒頭に必ず含めることで、LLMが文脈を正しく維持できます。

## 🧩 フェーズ別：LLMへのプロンプト例（拡張形式）

### フェーズ0：プロジェクト進行ルールの定義

```
このプロジェクトはLLMとの協調によってウォーターフォール型で進行します。
以下のルールに基づき、以降の各フェーズにおいて振る舞ってください：
...
（従来のルールに加え、上記【共通情報】を毎回再提示すること）
```

### フェーズ1：要件定義

```
【共通情報】...（テンプレ通りに記載）

あなたはソフトウェアアーキテクトです。
このフェーズでは：
- ユーザーの目的や使用シナリオの整理
- 実現にあたり必要となる前提条件や制約事項の洗い出し
- 要件の分類（機能要件・非機能要件）
に限定してください。
```

### フェーズ2：設計

```
【共通情報】...（テンプレ通りに記載）

このフェーズでは以下を整理してください：
- システム構成（クライアント／サーバー）
- 各コンポーネントの責務
- 使用する主要ライブラリやフレームワーク
- 各モジュールのインタフェース定義（簡易）
```

### フェーズ3：実装

```
【共通情報】...（テンプレ通りに記載）

この設計に基づいて、以下の機能をC#で実装してください：
- 顔ぼかし機能
- 入力は画像ファイルのパス、出力はぼかし画像のファイルパス
必要なライブラリは明示してください。
```

### フェーズ4：テスト

```
【共通情報】...（テンプレ通りに記載）

以下のC#コードに対する単体テストをxUnitで作成してください：
- 正常系
- 異常系（ファイルなし、形式不正）
テストケースは3つ以上、コメント付きで提示してください。
```

## 🔁 各フェーズ後の反省会

各フェーズの終了時には、以下の観点で**LLMと使用者（1対1）の対話内容**を振り返り、次フェーズのプロンプト改善や運用改善を行ってください。これは**LLMと使用者の反省会**であり、チーム内での議論は前提としていません。

一方で、プロンプト改善や学びをチームで共有する目的がある場合は、必要に応じて要点をチーム内で展開してください（例：Notionへの記録やショートレビューなど）。

### 振り返り観点（LLMと使用者間の反省会）
- 指示が曖昧だった箇所はなかったか？
- 出力が冗長・不明瞭だった点はなかったか？
- 無駄なやり取りや、誤った前提で進んでいなかったか？
- 出力が共通情報と矛盾していなかったか？
- 成果物が次フェーズの前提として使える品質だったか？
- フェーズごとの切り替えタイミングは適切だったか？

### 実施タイミング
- フェーズ完了後、LLMとのやりとり履歴を参照しながら、個別に振り返りを行う。
- 次フェーズに向けて、再掲情報・プロンプト・目的表現を改善する。
- チーム内では、共有価値のある改善事例や失敗事例を要点のみ抜粋して展開する。

## ✅ メリット

- コンテキスト制約への対処
- 品質の安定
- 再利用性の向上

## 📎 推奨フォーマット

- 成果物はMarkdown
- 共通情報テンプレートを全フェーズで再利用
- フェーズ開始・終了の記録をNotion/Gitで管理
