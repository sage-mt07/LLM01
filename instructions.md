# 📘 `instructions.md` の効果的な使い方（Claude/GPT対応）

## 🎯 目的

`instructions.md` は GitHub Copilot（Claude や GPT を含む）に、プロジェクトのルールや文脈、制約条件を伝えるためのガイドラインファイルです。適切に使うことで、補完の精度と一貫性が大幅に向上します。

---

## 📁 推奨配置構成

| 配置先 | 適用対象 | 説明 |
|--------|----------|------|
| `.github/copilot/instructions.md` | プロジェクト全体共通 | 命名規則、文字コード、基本方針など |
| 各フォルダの `instructions.md` | 対象フォルダ専用 | 要件定義、基本設計、試験計画、コード調査など用途別に設定 |
| 親フォルダの継承 | されない | 子フォルダに `instructions.md` があると共通ルールは無視されるため、必要に応じて手動で共通ルールをコピーする |

---

## ✍️ 効果的な記述順（Claude/GPT に伝わりやすい順序）

1. 🎯 目的・背景（何のためのルールか）
2. ⚙ 基本ルール（エンコーディング、スタイル、命名など）
3. 🏢 業務ルール・制約
4. 💻 サブシステム固有ルール（言語やツール、ライブラリ）
5. 🖋 命名規則・コメント規則
6. 📄 出力形式（箇条書き、Markdown表など）
7. 📝 補足・除外事項

> Claude や GPT はファイル冒頭の指示を最も重視するため、重要なことほど上に書く。

---

## 📏 サイズの目安

- **推奨サイズ**：4KB ～ 8KB（1000～2000トークン程度）
- **行数目安**：200～400行以内
- **長すぎると**：後半のルールが LLM に無視される可能性がある

---

## 🤖 Copilot Chat による圧縮方法

1. `instructions.md` の内容を選択
2. Copilot Chat に貼り付けて、次のように指示：

```
Claude に伝わるように、2000トークン以内で要約・箇条書き化してください。重要なルールは削らず残してください。
```

---

## 🧩 `.code-workspace` との併用（マルチ用途向け）

複数の用途（例：設計・調査・試験）でフォルダを分けている場合、`.code-workspace` を使用してフォルダごとに instructions.md を切り替えるのが効果的です。

### 例（プロジェクト.code-workspace）:

```json
{
  "folders": [
    { "path": "要件定義フォルダ" },
    { "path": "基本設計フォルダ" },
    { "path": "試験計画フォルダ" },
    { "path": "コード調査フォルダ" }
  ]
}
```

---

## 💡 例：記述例（Claude/GPT向け）

### 命名規則
```markdown
- クラス名：PascalCase（例：UserService）
- 関数名・変数名：camelCase（例：getUserList）
- 定数：SNAKE_CASE（例：MAX_RETRY_COUNT）
```

### 基本ルール
```markdown
- 文字コードは UTF-8（BOMなし）
- コメントは原則日本語
- ログは JSON 形式（Serilog）
```

### Claude向け指示例
```markdown
- Claude は PowerShell と Bash を混同することがあるため、明示してください
- Shift_JIS（codepage 932）は使用せず、必ず UTF-8 を使用してください
- PowerShell 5.1 を対象とし、`&&` の代わりに `if ($?) {}` を使用してください
```

---

## ✅ まとめ

| 項目 | 内容 |
|------|------|
| 配置 | 共通ルールは `.github/copilot/` に、用途別ルールは各フォルダに |
| 優先順位 | 個別 `instructions.md` がある場合、共通ルールは無視される |
| サイズ制限 | 約4〜8KB（2000トークン）を目安に要約・分割 |
| Claude/GPT 最適化 | 最初に目的・方針を記載、命令文ベースで、簡潔に記述 |
